<canvas id="callgraph_canvas" width="1024" height="768">
</canvas>

<script>

var nodeInfo = {
};

var callGraphData = [
];

function pivo_addCallGraphNode(id, name, timeTotal, timeTotalPct)
{
	if (typeof nodeInfo[id] === 'undefined')
		nodeInfo[id] = { 'name': name, 'callCount': 0, 'timeTotal': timeTotal, 'timeTotalPct': timeTotalPct, 'callerCredit': 0 };
}

function pivo_addCallGraphEdge(source, dest, callCount)
{
	callGraphData.push({
		'caller': source,
		'callee': dest,
		'callCount': callCount
	});

	nodeInfo[source].callerCredit += callCount;
	nodeInfo[dest].callCount += callCount;
}

function pivo_initCallGraphData()
{
	<#BEGIN CALL_GRAPH_DATA#>
	pivo_addCallGraphNode(<#VALUE CALLER_ID#>, '<#VALUE CALLER_NAME#>', <#VALUE CALLER_FLAT_TIME#>, <#VALUE CALLER_FLAT_TIME_PCT#>);
	pivo_addCallGraphNode(<#VALUE CALLEE_ID#>, '<#VALUE CALLEE_NAME#>', <#VALUE CALLEE_FLAT_TIME#>, <#VALUE CALLEE_FLAT_TIME_PCT#>);
	pivo_addCallGraphEdge(<#VALUE CALLER_ID#>, <#VALUE CALLEE_ID#>, <#VALUE CALL_COUNT#>);
	<#END CALL_GRAPH_DATA#>
}

document.addEventListener("DOMContentLoaded", function(event) {
	pivo_initCallGraphData();
	
	var graph = new Springy.Graph();

	for (var i in nodeInfo)
	{
		if (nodeInfo[i].callerCredit < 1000 && nodeInfo[i].callCount < 1000)
			continue;
		nodeInfo[i].node = graph.newNode({ label: nodeInfo[i].name });
	}
	
	for (var i in callGraphData)
	{
		if (typeof nodeInfo[callGraphData[i].caller] === 'undefined' || typeof nodeInfo[callGraphData[i].callee] === 'undefined' ||
			typeof nodeInfo[callGraphData[i].caller].node === 'undefined' || typeof nodeInfo[callGraphData[i].callee].node)
			continue;

		graph.newEdge(nodeInfo[callGraphData[i].caller].node, nodeInfo[callGraphData[i].callee].node);
	}
	
	$('#callgraph_canvas').springy({ graph: graph });
});

</script>

Basic info:<br />
<ul>
<#BEGIN SUMMARY#>
	<li><#VALUE KEY#>: <#VALUE CONTENT#></li>
<#END SUMMARY#>
</ul>

<table class="flatview">
	<thead>
		<tr>
			<th>%&nbsp;time</th>
			<th>Total&nbsp;time</th>
			<th>%&nbsp;inclusive time</th>
			<th>Total&nbsp;inclusive time</th>
			<th>Call&nbsp;count</th>
			<th>Function&nbsp;name</th>
		</tr>
	</thead>
	<tbody>
<#BEGIN FLAT_VIEW_ROWS#>
	<tr>
		<td><#VALUE PCT_TIME#></td>
		<td><#VALUE TOTAL_TIME#></td>
		<td><#VALUE PCT_INCLUSIVE_TIME#></td>
                <td><#VALUE TOTAL_INCLUSIVE_TIME#></td>
		<td><#VALUE CALL_COUNT#></td>
		<td class="nametd"><div class="tdfulltop padded"><#VALUE FUNCTION_NAME#></div><div class="tdfill func_bg_<#VALUE FUNCTION_TYPE#>" style="width: <#VALUE PCT_TIME#>%;"></div></td>
	</tr>
<#END FLAT_VIEW_ROWS#>
	</tbody>
</table>
